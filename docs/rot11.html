<strong>Objetivos</strong>:
- Conhecer o módulo TPM - Temporizador e PWM
- Implementar um controle de velocidades pelo PWM
<strong></strong>

<strong>Atividades</strong>:
- Teste: <a href="http://goo.gl/forms/WQo6F36zwe" target="_blank">Turma S</a>; <a href="http://goo.gl/forms/Wbt52DVesg" target="_blank">Turma T</a>; <a target="_blank" href="http://goo.gl/forms/8Xu7um0kBb">Turma E</a>; <a target="_blank" href="http://goo.gl/forms/ARhEzn9f5L">Turma M</a>; <a href="http://goo.gl/forms/SBv9Q12kRq" target="_blank">Turma U</a>; <a href="http://goo.gl/forms/0LtIG4Ctjf" target="_blank">Turma W</a>
- Estudo do módulo TPM (Cap. 31 do manual do KL25Z) @1623

<strong>Conexões do motor e fonte à placa, conector H7 (PWM):</strong>
<strong></strong>
<strong><img src="https://d1b10bmlvqabco.cloudfront.net/attach/i406dyu4aw75jl/hzle6mt0zvk237/i9zn0jmgzh41/Conexoes_PWMfoto.jpg"></strong>


Os pinos A, B, C, D são respectivamente os pinos 5,4,3,2 do conector H6 do esquemático a seguir:
<img src="https://d1b10bmlvqabco.cloudfront.net/attach/i406dyu4aw75jl/hzle6mt0zvk237/i9ytway88wr0/ConectorH6PWM.png">
As conexões a serem feitas são as seguintes:

Fonte de alimentação entre os pinos 5(A) e 4(B) (5 é terra e 4 é o positivo). O motor deve ser ligado entre os pinos 3 (C) e 2 (D).

<strong>Atenção:</strong> Observe que o pino que irá gerar o pulso para o motor é o PTB0. É preciso identificar qual é o número do TPM e o canal que será configurado para que o pulso PWM saia no pino PTB0. (Ver 10.3.1 do manual da KL25Z).

<strong>Habilitação do TPM:</strong>

<ul><li>Uma vez definido qual é o número do TPM, ele deve ser habilitado pelo SIM (<em>System Integration Module</em>) através do registrador SIM_SCGC6
<ul><li>Selecionar o MUX, colocando o pino PTB0 como saída do TPM, programando o registrador PORTB_PCR0 (Ver 11.5.1)</li></ul>
</li></ul>

<strong>Frequência do PWM: </strong>

<ul><li>Frequência de chaveamento: 100 Hz - Considerando que clock é de 20.48 MHz, escolher fonte de clock, valor do prescaler e valor do MOD.</li></ul>
Configuração do TPM para PWM simétrico:

<ul><li>Como o TPM pode funcionar nos 3 modos: output compare, input capture e PWM, deve-se configurar o TPM para funcionar no modo PWM simétrico. Utilize a <strong>Tabela 31-34</strong> do manual do KL25Z, para definir esta configuração: <strong>Center aligned PWM</strong>.</li></ul>

<strong>Programa a ser feito:</strong> folder prog11

<ul><li>Variar a velocidade do motor, de parado à velocidade máxima, utilizando qualquer forma (teclado, botão, etc.). Deve-se visualizar o ciclo de trabalho (<em>duty cycle</em>) do pulso PWM, de 0 a 100% em algum dispositivo, LCD, terminal serial ou LEDs vermelhos</li></ul>

<strong>Referências</strong>:

<ul><li>Manual do KL25Z: <a href="https://d1b10bmlvqabco.cloudfront.net/attach/i406dyu4aw75jl/hzle6mt0zvk237/i6micg8in2nc/KL25P80M48SF0RM.pdf" target="_blank">KL25P80M48SF0RM.pdf</a>
<ul><li>MUX do sinal: 10.3.1</li><li>Módulo PWM: Cap. 31</li></ul>
</li></ul>
